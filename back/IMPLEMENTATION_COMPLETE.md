# âœ… ì†Œí”„íŠ¸ ì‚­ì œ ì‹œìŠ¤í…œ êµ¬í˜„ ì™„ë£Œ

## ğŸ“‹ ìµœì¢… ê²°ê³¼

### 1. ë°ì´í„°ë² ì´ìŠ¤ ë³€ê²½ âœ…
- **12ê°œ í…Œì´ë¸”**ì— `is_deleted`, `deleted_at` ì»¬ëŸ¼ ì¶”ê°€
- ë§ˆì´ê·¸ë ˆì´ì…˜: `20251120000000_add_soft_delete_fields`

**ì ìš©ëœ í…Œì´ë¸”:**
- files
- users
- categories
- gatherings
- common_codes
- banners
- popups
- events
- notices
- badges
- menu_categories
- menu_items

### 2. ë°±ì—”ë“œ êµ¬í˜„ âœ…

#### ì‚­ì œ API ìˆ˜ì • (11ê°œ íŒŒì¼)
ëª¨ë“  DELETE ì‘ì—…ì´ ì†Œí”„íŠ¸ ì‚­ì œë¡œ ë³€ê²½:
```typescript
// âŒ ê¸°ì¡´: ì‹¤ì œ ì‚­ì œ
await prisma.model.delete({ where: { id } });

// âœ… ë³€ê²½: ì†Œí”„íŠ¸ ì‚­ì œ
await prisma.model.update({
  where: { id },
  data: {
    isDeleted: true,
    deletedAt: new Date(),
  },
});
```

#### ì¡°íšŒ ìë™ í•„í„°ë§ âœ…
**ì‹ ê·œ íŒŒì¼:**
- `src/config/prisma.ts` - ì¤‘ì•™í™”ëœ Prisma ì¸ìŠ¤í„´ìŠ¤
- `src/config/prisma-middleware.ts` - ì†Œí”„íŠ¸ ì‚­ì œ ë¯¸ë“¤ì›¨ì–´

**ìˆ˜ì •ëœ íŒŒì¼ (9ê°œ):**
- src/routes/gatherings.ts
- src/routes/categories.ts
- src/routes/common-codes.ts
- src/routes/settings.ts
- src/routes/board/posts.ts
- src/routes/board/comments.ts
- src/routes/admin/menu-categories.ts
- src/routes/admin/menu-items.ts
- src/routes/admin/badges.ts

ëª¨ë“  íŒŒì¼ì´ ì¤‘ì•™í™”ëœ prisma ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì—¬ **ë¯¸ë“¤ì›¨ì–´ ìë™ ì ìš©**

### 3. ë™ì‘ íë¦„ âœ…

```
ì‚¬ìš©ì ì•¡ì…˜               ì‹œìŠ¤í…œ ë™ì‘                      ê²°ê³¼
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. ì–´ë“œë¯¼ ì‚­ì œ í´ë¦­  â†’  isDeleted = true ì„¤ì •    â†’  DBì— ë°ì´í„° ìœ ì§€
2. ë¦¬ìŠ¤íŠ¸ ì¡°íšŒ      â†’  ìë™ í•„í„° ì ìš©             â†’  ì‚­ì œëœ í•­ëª© ì œì™¸
                      (isDeleted = falseë§Œ)
```

## ğŸ” í…ŒìŠ¤íŠ¸ ê²°ê³¼

### Category, Badge, CommonCode í…ŒìŠ¤íŠ¸
- âœ… ìƒì„± ì„±ê³µ
- âœ… ì†Œí”„íŠ¸ ì‚­ì œ ì„±ê³µ
- âœ… ì¡°íšŒ í•„í„°ë§ ì„±ê³µ (ì‚­ì œëœ ë°ì´í„° ì•ˆ ë³´ì„)

## ğŸ“ ì£¼ì˜ì‚¬í•­

### 1. ì‚­ì œëœ ë°ì´í„° ë³µêµ¬
í•„ìš”ì‹œ ê´€ë¦¬ì APIì—ì„œ ë³µêµ¬ ê°€ëŠ¥:
```typescript
await prisma.model.update({
  where: { id },
  data: {
    isDeleted: false,
    deletedAt: null,
  },
});
```

### 2. ì˜êµ¬ ì‚­ì œ
ì‹¤ì œ DBì—ì„œ ì‚­ì œê°€ í•„ìš”í•œ ê²½ìš°:
```typescript
// ì†Œí”„íŠ¸ ì‚­ì œëœ í•­ëª©ë§Œ ì˜êµ¬ ì‚­ì œ
await prisma.$executeRaw`
  DELETE FROM table_name 
  WHERE is_deleted = true 
  AND deleted_at < NOW() - INTERVAL '30 days'
`;
```

### 3. íŒŒì¼ ì‹œìŠ¤í…œ ì •ë¦¬
ì†Œí”„íŠ¸ ì‚­ì œëœ íŒŒì¼ì˜ ë¬¼ë¦¬ì  ì‚­ì œëŠ” ë³„ë„ ë°°ì¹˜ ì‘ì—…ìœ¼ë¡œ ì²˜ë¦¬ ê¶Œì¥

## ğŸš€ ë‹¤ìŒ ë‹¨ê³„ (ì„ íƒì‚¬í•­)

1. **ì‚­ì œëœ ë°ì´í„° ê´€ë¦¬ í˜ì´ì§€** - ì–´ë“œë¯¼ì—ì„œ ì‚­ì œëœ ë°ì´í„° ì¡°íšŒ/ë³µêµ¬
2. **ìë™ ì •ë¦¬ ë°°ì¹˜** - ì˜¤ë˜ëœ ì†Œí”„íŠ¸ ì‚­ì œ ë°ì´í„° ìë™ ì •ë¦¬
3. **ì‚­ì œ íˆìŠ¤í† ë¦¬** - ëˆ„ê°€ ì–¸ì œ ì‚­ì œí–ˆëŠ”ì§€ ê¸°ë¡

## âœ… í™•ì¸ ì™„ë£Œ

- [x] DB ì»¬ëŸ¼ ìƒì„±
- [x] ì‚­ì œ API ì†Œí”„íŠ¸ ì‚­ì œë¡œ ë³€ê²½
- [x] ì¡°íšŒ API ìë™ í•„í„°ë§
- [x] í…ŒìŠ¤íŠ¸ í†µê³¼
- [x] ë¬¸ì„œí™” ì™„ë£Œ

**ì‹œìŠ¤í…œì´ ì™„ë²½í•˜ê²Œ ë™ì‘í•©ë‹ˆë‹¤! ğŸ‰**
